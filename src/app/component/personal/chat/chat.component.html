<div class="flex-grow-1 d-flex justify-content-center bg-white mt-5 p-5 rounded-top-5">
    <div class="w-75 row">
        <div class="col-3 border rounded-start-3 p-0 d-flex flex-column">
            <div>
                <mat-form-field class="w-100 search" subscriptSizing="dynamic">
                    <input matInput placeholder="Cari">
                </mat-form-field>
            </div>
            <div>
              <div *ngFor="let chatRoom of userChatRooms" class="d-flex align-items-center p-3 chat" [ngClass]="currentChatRoom?.recipient == chatRoom.recipient ? 'chat-selected' : '' " (click)="openChat(chatRoom)">
                <img src="assets/image/profile.png" class="profile">
                <div class="d-flex flex-column ms-3 flex-grow-1" style="min-width: 0;">
                  <span class="mb-2">{{chatRoom.recipient.name}}</span>
                  <span class="mt-2 text-secondary" style="text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">{{chatRoom.chatRoom.chats.length > 0 ? chatRoom.chatRoom.chats[0].message : '&nbsp;'}}</span>
                </div>
              </div>
            </div>
        </div>
        <div class="col-9 border border-start-0 rounded-end-3 p-0 d-flex flex-column">
            <ng-container *ngIf="currentChatRoom">
              <div style="height: 56px;" class="border-bottom d-flex align-items-center">
                <span class="fw-medium ms-3">{{currentChatRoom.recipient.name}}</span>
              </div>
              <div class="flex-grow-1 d-flex p-3"  style="height: 0;">
                <div class="flex-grow-1 d-flex flex-column-reverse overflow-y-auto overflow-x-hidden">
                  <div *ngFor="let chat of currentChatRoom.chatRoom.chats" [ngClass]="chat.sender == email ? 'sender' : 'recipient'">
                    <div class="me-1 text-break">{{chat.message}}</div>
                    <div class="text-secondary" style="font-size: 0.8rem">{{chat.createdDt | date : 'HH:mm'}}</div>
                  </div>
                </div>
              </div>
              <div class="p-2">
                <form (submit)="sendMessage(currentChatRoom.chatRoomId, currentChatRoom.recipient.email)">
                  <mat-form-field appearance="outline" class="w-100 message" subscriptSizing="dynamic">
                    <input matInput placeholder="Pesan..." #input>
                  </mat-form-field>
                </form>
              </div>
            </ng-container>
        </div>
    </div>
</div>
